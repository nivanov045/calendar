# curly-waffle

## Возможности
* создать пользователя
* создать встречу в календаре пользователя со списком приглашенных пользователей
* получить детали встречи
* принять или отклонить приглашение другого пользователя
* найти все встречи пользователя для заданного промежутка времени
* для заданного списка пользователей и минимальной продолжительности встречи, найти ближайшей интервал времени, в котором все эти пользователи свободны

У встреч в календаре возможна следующая настройка повторов:
* без повтора
* каждый день
* каждую неделю
* каждый год
* с понедельника по пятницу

## Настройки сервера
Для указания адреса сервера можно использовать флаг командной строки `a` или переменную окружения `ADDRESS`. По умолчанию `127.0.0.1:8080`.
## Использование:
Сервер принимает `POST` и `GET` запросы с `content-type application/json`.

### Создание пользователя
#### Запрос
`POST` на `create-user` в формате

    {
        "info" : {
            "name" : "Ivan"
        }
    }

#### Ответы
* `200 OK` при успешном добавлении пользователя
* `400 Bad Request` при ошибке в запросе
* `404 Not Found` при иных ошибках

#### Формат успешного ответа
id созданного пользователя:

    {
        "id": "8c487d7a-a734-4c08-82f2-162c854ce827"
    }


### Создание встречи в календаре
#### Запрос
`POST` на `create-event-with-users` в формате

    {
        "candidates" : ["8c487d7a-a734-4c08-82f2-162c854ce827"],
        "participants" : ["c10ab64d-3860-46ef-bed6-46b8d3759928"],
        "start" : "2022-09-02T10:00:05Z",
        "finish" : "2022-09-02T11:00:05Z",
        "repeat_type" : 0,
        "info": {
            "name": "Some meeting name"
        }
    }
где `repeat_type` принимает одно из следующих значений в зависимости от типа повторения:
* `0` - без повтора
* `1` - каждый день
* `2` - каждую неделю
* `3` - каждый год
* `4` - с понедельника по пятницу

#### Ответы
* `200 OK` при успешном добавлении события в календарь
* `400 Bad Request` при ошибке в запросе
* `404 Not Found` при иных ошибках

#### Формат успешного ответа
id созданного мероприятия:

    {
        "id": "788dfa05-0f5d-4799-899a-c3b0e9eb3044"
    }


### Получение деталей встречи
#### Запрос
`GET` на `event-details` с id мероприятия в формате

    {
        "event": "788dfa05-0f5d-4799-899a-c3b0e9eb3044"
    }

#### Ответы
* `200 OK` при успешном существовании мероприятия и успешном получении деталей
* `400 Bad Request` при ошибке в запросе
* `404 Not Found` при иных ошибках, в том числе отсутствии мероприятия

#### Формат успешного ответа
Вся информация о событии:

    {
        "candidates" : ["8c487d7a-a734-4c08-82f2-162c854ce827"],
        "participants" : ["c10ab64d-3860-46ef-bed6-46b8d3759928"],
        "start" : "2022-09-02T10:00:05Z",
        "finish" : "2022-09-02T11:00:05Z",
        "repeat_type" : 0,
        "info": {
            "name": "Some meeting name"
        }
    }


### Принятие приглашения на встречу
#### Запрос
`POST` на `accept-invitation` с id пользователя и мероприятия в формате

    {
        "user": "8c487d7a-a734-4c08-82f2-162c854ce827"
        "event": "788dfa05-0f5d-4799-899a-c3b0e9eb3044"
    }

#### Ответы
* `200 OK` при успешном принятии приглашения
* `400 Bad Request` при ошибке в запросе
* `404 Not Found` при иных ошибках

### Отказ на приглашения на встречу
#### Запрос
`POST` на `reject-invitation` с id пользователя и мероприятия в формате

    {
        "user": "8c487d7a-a734-4c08-82f2-162c854ce827"
        "event": "788dfa05-0f5d-4799-899a-c3b0e9eb3044"
    }

#### Ответы
* `200 OK` при успешном отказе от приглашения
* `400 Bad Request` при ошибке в запросе
* `404 Not Found` при иных ошибках


### Получение всех встреч пользователя в заданном промежутке
#### Запрос
`GET` на `events` с id пользователя и временной промежуток в формате

    {
        "user" : "8c487d7a-a734-4c08-82f2-162c854ce827",
        "from" : "2022-09-02T10:00:05Z",
        "to"   : "2022-09-02T11:00:05Z",
    }

#### Ответы
* `200 OK` при успешном отказе от приглашения
* `400 Bad Request` при ошибке в запросе
* `404 Not Found` при иных ошибках

#### Формат успешного ответа
Вся информация о событиях, пересекающихся с заданным промежутком:

    {
        [
            {
                "id" : "375d9831-592c-4373-8398-e22a54eaff2c"
                "candidates" : [],
                "participants" : ["c10ab64d-3860-46ef-bed6-46b8d3759928"],
                "start" : "2022-09-02T10:00:05Z",
                "finish" : "2022-09-02T11:00:05Z",
                "repeat_type" : 0,
                "info": {
                    "name": "Some meeting name 1"
                }
            },
            {
                "id" : "36492a24-24ba-478b-90b4-583486123291"
                "candidates" : ["87bbd840-a07a-4ef2-9407-09523695f690"],
                "participants" : ["ce48717b-ec68-4dfd-8917-fe59c8724b7e"],
                "start" : "2022-09-02T10:00:05Z",
                "finish" : "2022-09-02T11:00:05Z",
                "repeat_type" : 1,
                "info": {
                    "name": "Some meeting name 2"
                }
            }
        ]
    }


### Поиск свободного промежутка для группы пользователей
#### Запрос
`GET` на `find-slot` с id пользователей, продолжительности встречи в наносекундах и время, после которого искать встречу уже не нужно

    {
        "users" : [
            "8c487d7a-a734-4c08-82f2-162c854ce827",
            "375d9831-592c-4373-8398-e22a54eaff2c"
        ],
        "duration" : 1800000000000,
        "valid_until" : "2022-10-02T11:00:00Z",
    }

#### Ответы
* `200 OK` при успешном отказе от приглашения
* `400 Bad Request` при ошибке в запросе
* `404 Not Found` при иных ошибках

#### Формат успешного ответа
Время начала найденного временного окна:

    {
        "begin": "2022-09-05T11:00:00Z"
    }
